generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 String   @id @default(uuid())
  name               String
  email              String   @unique
  password           String
  avatarUrl          String?
  subscriptionStatus String?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
  coupleId           String?  @unique

  couple          Couple? @relation("UsersCouple", fields: [coupleId], references: [id])
  relationAsUser1 Couple? @relation("CoupleUser1")
  relationAsUser2 Couple? @relation("CoupleUser2")

  @@map("users")
}

model Couple {
  id                 String   @id @default(uuid())
  user1Id            String   @unique
  user2Id            String   @unique
  relationshipStatus String
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  user1 User  @relation("CoupleUser1", fields: [user1Id], references: [id])
  user2 User  @relation("CoupleUser2", fields: [user2Id], references: [id])
  user  User? @relation("UsersCouple")

  @@map("couples")
}
